# =========================
# RabbitMQ Configuration
# =========================

# -------------------------
# Authentication
# -------------------------
# Default user/password สามารถตั้งใน docker-compose environment
# RABBITMQ_DEFAULT_USER / RABBITMQ_DEFAULT_PASS

# -------------------------
# Networking
# -------------------------
listeners.tcp.default = 5672          # AMQP
management.listener.port = 15672      # Management UI
management.listener.ssl = false

# -------------------------
# Memory Management
# -------------------------
# ใช้สัดส่วนของ memory ของ host machine
vm_memory_high_watermark.relative = 0.8  # 80% ของ RAM
vm_memory_high_watermark.absolute = 28GB  # ถ้าอยาก fix memory สูงสุด

# -------------------------
# Disk Management
# -------------------------
# ถ้า disk free น้อยกว่า limit จะหยุดรับ message
disk_free_limit.absolute = 2GB

# -------------------------
# Queue & Message settings
# -------------------------
# เพิ่ม performance สำหรับ high-throughput queues
# ทำ durable queues และ persistent messages ตามต้องการ
queue_index_embed_msgs_below = 65536   # 64 KB    # embed small messages เพื่อ performance

# -------------------------
# Logging
# -------------------------
log.console = true
log.console.level = info
log.file.level = info

# -------------------------
# Clustering (ถ้ามีหลาย node)
# -------------------------
# cluster_formation.peer_discovery_backend = classic_config
# cluster_name = rabbit@myhost

# -------------------------
# TCP socket tuning
# -------------------------
# ปรับ buffer สำหรับ throughput สูง
tcp_listen_options.backlog = 2048
tcp_listen_options.nodelay = true
tcp_listen_options.keepalive = true
